// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id       String     @id @default(uuid())
  id_user  Int        @default(autoincrement())
  status   Boolean    @default(true)
  name     String
  email    String
  password String
  cpf      String
  rg       String?
  access   AccessType @default(USER)

  @@map("users")
}

model Consultant {
  id            String     @id @default(uuid())
  id_consultant Int        @default(autoincrement())
  status        Boolean    @default(true)
  name          String
  email         String
  password      String
  cpf           String
  rg            String?
  access        AccessType @default(VENDEDOR)
  proposal      Proposal[]

  @@map("consultants")
}

model Customer {
  id            String     @id @default(uuid())
  id_customer   Int        @default(autoincrement())
  razao_social  String
  nome_fantasia String
  cnpj          String
  email         String
  adress        String?
  phone         String?
  site          String?
  proposal      Proposal[]

  @@map("customers")
}

model Product {
  id            String @id @default(uuid())
  description   String
  unitary_value Float

  category    Category @relation(fields: [id_category], references: [id])
  id_category String

  produtoProposta ProposalProducts?

  @@map("produtos")
}

model Category {
  id            String @id @default(uuid())
  id_category   Int    @default(autoincrement())
  category_name String

  products Product[]

  @@map("categories")
}

model ProposalProducts {
  id       String @id @default(uuid())
  quantity Int

  product  Product  @relation(fields: [id_product], references: [id])
  proposal Proposal @relation(fields: [id_proposal], references: [id])

  id_product  String @unique
  id_proposal String

  @@map("proposed_products")
}

model Proposal {
  id              String   @id @default(uuid())
  number_proposal Int      @default(autoincrement())
  status          Boolean  @default(true)
  total_price     Float
  payment_term    Int
  description     String?
  createdAt       DateTime @default(now())

  //Relations

  customer      Customer   @relation(fields: [id_customer], references: [id])
  consultant    Consultant @relation(fields: [id_consultant], references: [id])
  id_customer   String
  id_consultant String

  proposed_products ProposalProducts[]

  @@map("proposals")
}

enum AccessType {
  USER
  ADMIN
  VENDEDOR
}
